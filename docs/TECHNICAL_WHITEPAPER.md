# テクニカル・ホワイトペーパー：通信制高校選択支援プラットフォーム (CSFS)
## 心理学的多次元分析とAI推論を用いた意思決定支援システムの設計と実装

**Version**: 1.1.0 (Critical Revised Edition)
**Date**: 2026-02-23
**Author**: One Drop Development Team / Lead Architect

---

## 1. エグゼクティブ・サマリー
本プロジェクトは、通信制高校進学を検討する生徒および保護者を対象とした意思決定支援システム（Decision Support System: DSS）の構築である。
本システムは、React, Spring Boot, 生成AI（LLM）を統合したモダンなアーキテクチャを採用しているが、技術的実装以上に、進路選択という「高リスクな意思決定」における心理的因子の定量化と可視化に主眼を置いている。
本稿では、実装の詳細を記述するとともに、現状のシステムが抱える心理測定学的妥当性の課題、アーキテクチャの過剰性、およびアルゴリズムの倫理性についても批判的に考察し、次期フェーズにおける実証研究のロードマップを提示する。

## 2. 背景と市場課題の定義
### 2.1. 通信制高校市場の急拡大と選択の不透明性
文部科学省の調査が示す通り、通信制高校はもはや不登校の受け皿ではなく、多様な教育ニーズに応える選択肢へと変容した。しかし、教育内容の非定型性が、利用者側の「評価基準の不在」を招き、結果として広告資本に依存した学校選択が行われている。

### 2.2. 親子間の価値観の乖離（ステークホルダー・コンフリクト）
中学生という発達段階にある主たるユーザーと、決定権を持つ保護者の間には、しばしば「スクーリングの現実性」と「将来の経済性」を巡る深刻な合意形成の断絶が存在する。この断絶を埋める客観的かつ対話的な指標の提供が、本システムの社会的使命である。

## 3. プロダクト・ビジョンと解決アプローチ
### 3.1. 「納得感」の創出：8次元評価モデル
本プロジェクトは、教育心理学的な視点に基づき、意思決定因子を以下の8軸に構造化した。
1. **AX01 (Schooling)**: スクーリング頻度許容度
2. **AX02 (Cost)**: 経済的費用感度
3. **AX03 (Online)**: オンライン学習適応性
4. **AX04 (Support)**: 自己管理能力 vs サポート需要
5. **AX05 (Career)**: キャリア・進路志向
6. **AX06 (Life)**: 学校生活経験優先度
7. **AX07 (Mental)**: メンタルヘルス・支援ニーズ
8. **AX08 (Interest)**: 特化型スキル・興味関心

### 3.2. 【批判的考察】モデルの妥当性と心理測定学的課題
現状の8軸モデルは、理論的な納得感はあるものの、以下の学術的検証が未完了である。
*   **因子妥当性**: 探索的因子分析（EFA）および確認的因子分析（CFA）による構造の裏付けがなされていない。
*   **信頼性**: 各軸を構成する質問項目間の内的整合性（Cronbach's α係数）の算出が不十分である。
*   **基準関連妥当性**: 本診断結果と、入学後の満足度や継続率との相関データが存在しない。
現在のアルゴリズムは「心理測定」ではなく、暫定的な「ヒューリスティック・ロジック」に基づいていることを明記する必要がある。

## 4. システムアーキテクチャの詳細
### 4.1. 全体構成概要
```mermaid
graph TD
    User((User / Browser)) -->|Access LP| Next[Next.js (Landing Page)]
    User -->|Start Diagnosis| React[React / Vite (SPA)]
    
    subgraph Frontend Ecosystem
        Next
        React
    end

    subgraph Backend Services
        React -->|Request PDF| Spring[Java / Spring Boot API]
        React -->|Get Advice| Netlify[Netlify Functions (Node.js)]
        Netlify -->|Prompt| Gemini[Google Gemini API]
    end
```

### 4.2. 【批判的考察】過剰分散アーキテクチャへの反省
本システムは、React, Next.js, Spring Boot, Netlify Functionsという4つの異なる環境を維持している。
*   **オーバースペックの懸念**: MVP（Minimum Viable Product）としては、Node.js単一スタックでの構築が可能であった。特にSpring Bootサーバーの維持は、運用コストとコールドスタート時のレイテンシを招いている。
*   **選定理由の再定義**: この構成は「現状の最適解」ではなく、将来的な大規模学校データベースとの連携、およびエンタープライズレベルの帳票出力（Javaの強み）を見越した「先行投資的設計」である。

## 5. フロントエンド実装とUX
### 5.1. レスポンシブと画像保存戦略
モバイルユーザーに対し、Web Share APIを活用したネイティブな保存体験を提供。PC環境ではjsPDFによる高精度なPDF生成を行い、環境に応じた最適化（Strategy Pattern）を実装している。

## 6. バックエンド：Spring Bootによる帳票エンジン
OpenPDFを採用し、IPAフォントの埋め込みによる完全なポータビリティを実現。これはクライアントサイドでのCanvas汚染問題やフォント欠落を回避するための選択である。

## 7. AI推論基盤とプロンプトエンジニアリング
### 7.1. Gemini APIによる個別アドバイス
JSON schemaを強制するプロンプト設計により、非定型なAI出力を構造化データとしてUIに統合。

### 7.2. 【批判的考察】LLMの倫理的説明責任
教育・進路という個人の人生を左右する領域において、LLMの助言を無加工で提示することには以下のリスクが伴う。
*   **ハルシネーション**: 事実に基づかないアドバイスが、ユーザーの不安を煽る、あるいは過度な期待を抱かせる可能性。
*   **ガバナンス**: 現状、AIの出力ログを監査する仕組みが欠如しており、「Human-in-the-loop」の設計が今後の最優先課題である。

## 8. アルゴリズム：スコアリングとデータ同期
### 8.1. 【批判的考察】スコアリング計算の単純化
現状の単純平均およびKnockout質問による一律1.4倍の係数（Arbitrary Weighting）は、統計学的な根拠に乏しい。
*   **改善案**: 項目反応理論（IRT）を用いた質問の識別力の考慮、および各項目の負荷量に基づいた加重平均への移行が必要である。

### 8.2. LocalStorage同期の限界
Stateless Syncはプライバシー面で優位だが、以下の実運用上の脆弱性を持つ。
*   iOS SafariのStorage削除仕様によるデータ消失。
*   シークレットブラウジング環境での動作不能。
*   デバイスを跨いだ診断継続の困難。

## 9. 品質保証と保守管理
Vitestによる `scoring.ts` の単体テストを実装。ディレクトリ構造の整理（archive化）により、技術的負債を視覚化し、保守性を高めている。

## 10. セキュリティとプライバシーへの配慮
### 10.1. 【批判的考察】GDPR/CCPA準拠への過剰主張
「PIIをサーバーに持たない」ことは安全性の必要条件だが、十分条件ではない。
*   IPアドレスやユーザーエージェントを含むアクセスログ、Analyticsによる行動追跡の有無など、より厳格なプライバシーポリシーとCookieポリシーの策定が不可欠である。

## 11. 倫理的リスク管理：心理的ラベリングの回避
診断結果が「あなたは〇〇型である」という固定的なラベリングとして機能し、ユーザーの可能性を狭めるリスクを考慮しなければならない。
特にAX07（メンタルヘルス）等のセンシティブな軸については、診断が「医療的診断」ではないことを強調し、専門家（カウンセラー等）へのアクセスを促す導線が必要である。

## 12. 今後の実証研究ロードマップ
本プロジェクトを単なるWebアプリから「教育工学研究」へと引き上げるため、以下のフェーズを定義する。
1.  **Phase 4**: 診断データの匿名収集と因子分析によるモデルの再構築。
2.  **Phase 5**: 入学後の追跡調査による構成概念妥当性の検証。
3.  **Phase 6**: AIアドバイスの品質評価テスト（教育専門家によるブラインドテスト）。

## 13. 結論
本CSFSプロジェクトは、技術的なショーケースとしては成功を収めているが、意思決定支援システムとしては「科学的妥当性」と「倫理的説明責任」の入り口に立ったに過ぎない。
エンジニアリングの真価は、最新のスタックを使うことではなく、そのシステムが社会に与えるインパクトを正確に測定し、誠実に改善し続けるプロセスに宿ると確信する。

---
**作成者**: One Drop 開発チーム / シニア・システムアーキテクト
**最終更新日**: 2026年2月23日
